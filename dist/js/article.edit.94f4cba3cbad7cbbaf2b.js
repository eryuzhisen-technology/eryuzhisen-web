webpackJsonp([6],{"9LVU":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("LL3X"),s=(i.n(a),i("bP92")),c=(i.n(s),i("7+uW")),n=i("whrU"),o=i.n(n),r=i("B6An"),l=i.n(r),d=i("kZEp"),h=i.n(d),u=i("387H"),p=i("YW4o"),_=i.n(p),f=i("or+c"),g=i.n(f),v=i("PoJi"),m=i.n(v);i.d(e,"Vue",function(){return c.default}),i.d(e,"store",function(){return g.a}),c.default.use(o.a),c.default.use(l.a),c.default.use(h.a),c.default.use(u.a),c.default.use(_.a),c.default.use(m.a)},"Jef/":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var a=i("NYxO");e.default={data:function(){return{resType:"edit",from:"",reg_title:!0,reg_content:!0,reg_title_con:"",reg_content_con:"",chapter_id:-1,catalog_id:-1,isUpdata:0,isCreate:!0,list:[],title:"",desc:"",content:""}},computed:(0,a.mapState)({user:function(t){return t.user.info},chapter:function(t){return t.opus.chapter.info},article:function(t){return t.opus.article},lists:function(t){return t.opus.chapter.lists}}),methods:{hideTip:function(){this.reg_title=!0,this.reg_title_con="",this.reg_content=!0,this.reg_content_con=""},edit_init:function(e){var i=this;this.editor=e,t(".j-save-btn").on("mouseenter",function(t){2!=i.isUpdata&&3!=i.isUpdata||(i.isUpdata=0)})},formback:function(){this.from&&(window.location.href=this.from)},updateCatalog:function(t){this.$eventHub.$emit("header_article_setShow",{show:!0,catalog:t})},removeCatalog:function(t){var e=this;this.$store.dispatch("bubble_showBubble",{show:!0,type:"warn",warn:{title:"确定要删除你的故事?",content:"删除后无法恢复，读者也将无法看见，请谨慎操作",comfireFn:function(){e.delCatalog(t)}}})},delCatalog:function(t){var e=this;this.$store.dispatch("opus_delCatalog",{catalogId:t}).then(function(t){e.getMyCatalogList(),e.$store.dispatch("bubble_success",t)}).catch(function(t){e.$store.dispatch("bubble_fail",t)})},remove:function(t){var e=this;this.$store.dispatch("bubble_showBubble",{show:!0,type:"warn",warn:{title:"确定要删除",content:"删除后将无法恢复，请谨慎处理",comfireFn:function(){e.deleteChapter(t)}}})},deleteChapter:function(t){var e=this;this.$store.dispatch("opus_deleteChapter",{chapterId:t}).then(function(t){e.getChapterList(e.catalog_id,!0),e.$store.dispatch("bubble_success",t)}).catch(function(t){e.$store.dispatch("bubble_fail",t)})},addCatalog:function(){this.$eventHub.$emit("header_article_setShow",{show:!0})},addEnpry:function(){this.isCreate=!1,this.addChapter(1)},check:function(e){var i=!0;return t.trim(this.title)?t.trim(this.title).length>30?(this.reg_title=!1,this.reg_title_con="章节标题超出最大字数",i=!1):(this.reg_title=!0,this.reg_title_con="",i=!0):(this.reg_title=!1,this.reg_title_con="填写章节标题",i=!1),"<p><br></p>"==t.trim(this.content)&&e?(this.reg_content=!1,this.reg_content_con="填写章节内容",i=!1):(this.reg_content=!0,this.reg_content_con="",i=!0),i},update:function(t){this.content=t,this.check()&&(this.chapter_id&&-1!=this.chapter_id?this.updateChapter(1):this.addChapter(1))},publish:function(t){this.content=t,this.check(!0)&&this.updateChapter(0)},scan:function(t){this.content=t;var e=this.$version.chapaterEdit_edit,i=e.key+"_"+this.catalog_id+"_"+this.chapter_id,a=this.$cache.getStore(e.key,e.version);a.chapter_title=this.title,a.chapter_desc=this.desc,a.chapter_content=this.content,this.$cache.setStore(i,a,e.version,e.time),window.location.href="./article.read.html?isScan=1&chapter_id="+this.chapter_id+"&catalog_id="+this.catalog_id},updateChapter:function(t){var e=this,i=this;1==t&&(this.isUpdata=1),this.$store.dispatch("opus_updateChapter",{chapter_id:this.chapter_id,chapter_title:this.title,chapter_desc:this.desc,chapter_content:this.content,chapter_status:t}).then(function(a){if(1==t){e.isUpdata=2;var s=e.$version.chapaterEdit_edit,c=s.key+"_"+e.catalog_id+"_"+e.chapter_id,n=e.$cache.getStore(c,s.version);n.chapter_title=e.title,n.chapter_desc=e.desc,n.chapter_content=e.content,e.$cache.setStore(c,n,s.version,s.time)}else e.$store.dispatch("bubble_showBubble",{show:!0,type:"complete",complete:{title:e.title},methods:{cancel:function(){i.isCreate=!0,i.getChapterList(i.catalog_id,!1)},comfire:function(){window.location.href="./article.read.html?catalog_id="+i.catalog_id+"&chapter_id="+i.chapter_id}}});e.$store.dispatch("bubble_success",a)}).catch(function(i){1==t&&(e.isUpdata=3),e.$store.dispatch("bubble_fail",i)})},addChapter:function(t){var e=this;this.$store.dispatch("opus_addChapter",{catalog_id:this.catalog_id,chapter_title:1==t?"无标题文章":this.title,chapter_desc:1==t?"":this.desc,chapter_content:1==t?"<p><br /></p>":this.content,chapter_status:t}).then(function(t){e.getChapterList(e.catalog_id,!0),e.$store.dispatch("bubble_success",t)}).catch(function(t){e.$store.dispatch("bubble_fail",t)})},getMyCatalogList:function(){var t=this;if(!this.user.isLogin&&"index"!=this.resType)return console.log("----error----on login, getCatalogList"),!1;this.$store.dispatch("opus_getMyCatalogList",{pagination:"1",page:this.pageIndex,pageSize:this.pageSize}).then(function(e){t.$emit("article_count",t.article.count),e.list.length&&(t.catalog_id=e.list[0].catalog_id,t.getChapterList(t.catalog_id,!0)),t.$store.dispatch("bubble_success",e)}).catch(function(e){t.$store.dispatch("bubble_fail",e)})},getChapterList:function(t,e){var i=this;this.$store.dispatch("opus_getChapterList",{resType:"edit",catalogId:t,pagination:"1",page:1,pageSize:100}).then(function(a){i.catalog_id=t,a.list.length&&e?(i.chapter_id=a.list[0].chapter_id,i.getChapterDetail(i.chapter_id)):(i.chapter_id=-1,i.$store.dispatch("opus_setChapterInfo",{})),i.$store.dispatch("bubble_success",a)}).catch(function(t){i.$store.dispatch("bubble_fail",t)})},getChapterDetail:function(t){var e=this;this.$store.dispatch("opus_getChapterDetail",{chapterId:t}).then(function(i){e.chapter_id=t,e.$store.dispatch("bubble_success",i)}).catch(function(t){e.$store.dispatch("bubble_fail",t)})}},watch:{isUpdata:function(e){1==e?t(".j-save-btn").addClass("j-save-btn-update").find("a").text("保存中..."):2==e?(t(".j-save-btn").addClass("j-save-btn-update").find("a").text("已保存"),this.timeSave=setTimeout(function(e){t(".j-save-btn").removeClass("j-save-btn-update").find("a").text("保存")},3e3)):3==e?(t(".j-save-btn").addClass("j-save-btn-update").find("a").text("保存失败"),this.timeSave=setTimeout(function(e){t(".j-save-btn").removeClass("j-save-btn-update").find("a").text("保存")},3e3)):0==e&&(clearTimeout(this.timeSave),t(".j-save-btn").removeClass("j-save-btn-update").find("a").text("保存"))},chapter:function(t){this.content=t.chapter_content,this.title=t.chapter_title,this.desc=t.chapter_desc;var e=this.$version.chapaterEdit_edit,i=e.key+"_"+this.catalog_id+"_"+this.chapter_id;this.$cache.setStore(i,t,e.version,e.time)},lists:function(t){this.isCreate&&this.chapter_id}},created:function(){var t=this;this.$eventHub.$on("updateCatalog_success",function(e){t.getMyCatalogList()})},mounted:function(){var t=this;if(this.from=decodeURIComponent(this.$url.getUrlParam("from"))||"",this.getMyCatalogList(),this.chapter&&this.chapter_id){var e=this.$version.chapaterEdit;this.timer=setInterval(function(){var e=t.editor.$txt.html();t.update(e)},e.time)}else clearInterval(this.timer)}}}).call(e,i("7t+N"))},LL3X:function(t,e){},Vo9x:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-artice-edit"},[i("div",{staticClass:"m-artice-edit-wrap"},[i("div",{staticClass:"m-artice-edit__edit"},[i("div",{staticClass:"edit-catalog"},[i("div",{staticClass:"catalog-hd"},[i("div",{staticClass:"catalog-hd_back",on:{click:t.formback}},[t._v("返")]),t._v(" "),i("div",{staticClass:"catalog-hd_add",on:{click:t.addCatalog}},[t._v("创建新故事")])]),t._v(" "),i("div",{staticClass:"catalog-menu"},t._l(t.article.lists,function(e){return i("div",{staticClass:"catalog-menu_item",class:{"z-active":t.catalog_id==e.catalog_id},on:{click:function(i){t.getChapterList(e.catalog_id,!0)}}},[i("div",{staticClass:"catalog-menu_item-icon"}),t._v(" "),i("div",{staticClass:"catalog-menu_item-text"},[t._v(t._s(e.catalog_title))]),t._v(" "),i("div",{staticClass:"catalog-menu_item-more"},[i("div",{staticClass:"cpm_sub_more z-left"},[i("div",{staticClass:"item"},[i("div",{staticClass:"item-text",on:{click:function(i){i.stopPropagation(),t.updateCatalog(e)}}},[t._v("编辑")])]),t._v(" "),i("div",{staticClass:"item"},[i("div",{staticClass:"item-text",on:{click:function(i){i.stopPropagation(),t.removeCatalog(e.catalog_id)}}},[t._v("删除")])])])])])}))]),t._v(" "),i("div",{staticClass:"edit-chapter"},[t.catalog_id?i("div",{staticClass:"chapter-hd",on:{click:t.addEnpry}},[i("div",{staticClass:"chapter-hd_icon"}),t._v(" "),i("div",{staticClass:"chapter-hd_text"},[t._v("增加新章节")])]):t._e(),t._v(" "),t.lists&&t.lists.length?i("div",{staticClass:"chapter-menu"},t._l(t.lists,function(e){return i("div",{staticClass:"chapter-menu_item",class:{"z-active":t.chapter_id==e.chapter_id,"z-finish":0==e.chapter_status},on:{click:function(i){t.getChapterDetail(e.chapter_id)}}},[i("div",{staticClass:"chapter-menu_item-icon"}),t._v(" "),i("div",{staticClass:"chapter-menu_item-text"},[t._v(t._s(t.chapter_id!=e.chapter_id?e.chapter_title:t.title))]),t._v(" "),i("div",{staticClass:"chapter-menu_item-delete",on:{click:function(i){i.stopPropagation(),t.remove(e.chapter_id)}}})])})):t._e()]),t._v(" "),t.chapter&&-1!=t.chapter_id?i("div",{staticClass:"edit-content"},[0==t.chapter.chapter_status?i("div",{staticClass:"edit-content_read"},[i("div",{staticClass:"edit-content_read-title"},[t._v("\n                        "+t._s(t.chapter.chapter_title)+"\n                    ")]),t._v(" "),i("div",{staticClass:"edit-content_read-content",domProps:{innerHTML:t._s(t.chapter.chapter_content)}})]):i("div",{staticClass:"edit-content_edit"},[i("div",{staticClass:"edit-content_edit-title"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"edit-content_edit-title-input",attrs:{type:"text",placeholder:"填写章节标题"},domProps:{value:t.title},on:{focus:t.hideTip,input:function(e){e.target.composing||(t.title=e.target.value)}}}),t._v(" "),t.reg_title?t._e():i("div",{staticClass:"c-dialog__tip"},[i("div",{staticClass:"tip-arrow"}),t._v(" "),i("div",{staticClass:"tip-text"},[t._v(t._s(t.reg_title_con))])])]),t._v(" "),i("div",{staticClass:"edit-content_edit-body"},[i("Create",{attrs:{content:t.content},on:{update:t.update,publish:t.publish,scan:t.scan,edit_init:t.edit_init,edit_click:t.hideTip}}),t._v(" "),t.reg_content?t._e():i("div",{staticClass:"c-dialog__tip"},[i("div",{staticClass:"tip-arrow"}),t._v(" "),i("div",{staticClass:"tip-text"},[t._v(t._s(t.reg_content_con))])])],1)])]):t._e()]),t._v(" "),i("div",{staticClass:"cpm_clear"})]),t._v(" "),i("Edit",{attrs:{resType:t.resType}}),t._v(" "),i("Bubble")],1)},staticRenderFns:[]}},Xdpa:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABwBAMAAAAai8jqAAAAFVBMVEUAAAD///////////////////////9Iz20EAAAAB3RSTlMAGgUWEQ0Jmy1DOAAAA1BJREFUWMOlmE1zozAMhl0SOFcYcnYSmnPIJnsuadMzNLs956Pt//8JtUUdg10qe9BMZ0rgAduvZEtiQ1bsWaA9ANRhRAwAPIhJSlDMyZ+IJIGM8CYq+LbMl2ngZrkfcYSO/fUhrgCBTAGW7UMJmonhB6spCV3jJ1JClxGUhK5lwpcgJW2ga5slzVxtBa+UpPZLi7392d8lzIS83kfVb5LGFoHXtcXUPaLsy5CUavr8FPV/rwdExydx+si6buAKguPJcdX1CB1JnVk237cQLX5iGos43nwqKh0mdyXcyGsz5ERNamlJ6vywxMV8fxZ68TfOS23RW8lKSG8S227AbAmRSEyMFI6krEeosWtnSG/uyvsMs0Tf4WNTdWn2NRTXRlBa1AFtAtKEZpq+G7Ce6Frdu54X4o3YIB3RzbYwB2n3GrEkZZrQEhpkxlhP0sJCWgm1ne1wR0ltpBd1qF1mRa2LpGwYwbG6yD0zVrnIHYGgCKcgRC+YPxIh8vB55LUvkhgv8kWmY5DMfy5o/HARFkLokgct8hzjJwiZfodL8iJIxMjP2+i890bOkEWvaoAzb2QCWQK1JHPGFn5IIhUp18o9DxVsPZCVYNUsgq3eVdYkkkAaVRyf90WmwPXDh8Xn4vgiBpGP57fL6uPwdPPJMieknPbPqw9YV2sCiTvPXxo5/UVZE0gEre2EHNA5Z/9iTvrYWZ+GDWfznOEfgbQnwqPyk9M8ZRHMSIQlVevBMeTJo3LnnUeIPVR5G2Jv/5/UNzc+8SJu2ziO0jPEDJIJb6RB8fnWEDSiZ+6PYDSGIRMuMGoCEHbCLWOrwIugkOhNmGUT6gjNBpFUb5T8Vb77U8KlRKZanDkMHq9LkP9NUPcYBJZZqXW82oc4+ualxHNvpX54R1q9YyhVwM/M4s7BF9mpgpuQlABc3n9lRELSSXtinHEkGJH2dJOr1dOfnvgNJnc/p3ByADsTAmQKZxJFy674fSId1UanoybpRRtMep3UutB52XBqHZ7Au2WCYkyZsHPKhPBiJLzkCS+swsu3X4vEkigSUTKLcYn9+IKXLqtHFO9jWgR0I2J8u4Nuqoxv3dANokBmP77ZRbfURjTuxrcH6Sbk+FYn3VAd37YNbw5/Ac9rFE1VXLCxAAAAAElFTkSuQmCC"},bP92:function(t,e){},"cSj+":function(t,e,i){t.exports=i.p+"images/catalog.45e7cf3.png"},fZ3J:function(t,e,i){i("otfH");var a=i("VU/8")(i("Jef/"),i("Vo9x"),null,null);t.exports=a.exports},gdAc:function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}i("tYoD");var s=i("9LVU"),c=i("Yh7g"),n=a(c),o=i("e4Z7"),r=a(o),l=i("NEzH"),d=a(l),h=i("t/6I"),u=a(h),p=i("Eion"),_=a(p),f=i("BFCG"),g=a(f),v=i("nTmf"),m=a(v),C=i("W0Us"),b=a(C),A=i("VVx8"),w=a(A),x=i("5hbK"),B=a(x),k=i("V9fN"),y=a(k),E=i("fZ3J"),S=a(E);s.Vue.component("HeaderDom",n.default),s.Vue.component("FooterDom",r.default),s.Vue.component("MenuLeft",d.default),s.Vue.component("SideMenu",u.default),s.Vue.component("Bubble",_.default),s.Vue.component("Feedback",g.default),s.Vue.component("Page",m.default),s.Vue.component("Empty",b.default),s.Vue.component("Edit",w.default),s.Vue.component("UploadImg",B.default),s.Vue.component("Create",y.default),new s.Vue({el:"#app",store:s.store,render:function(t){return t(S.default)}})},mOGY:function(t,e,i){t.exports=i.p+"images/avatar.907f041.png"},otfH:function(t,e){},tMge:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAG1BMVEX///8AAACAgID19fXAwMBqamqWlpZAQEDr6+s5T65vAAAEQklEQVRYw8yYQY7bMAxFBXfsvQzE2TpGgGwLdNNlkBN4bmAfwblCL14NH0hakZpmZjWCEcgKv0ORn59ywp9fnxy/wxfGz88CfnxryG3ScQ43rmm6vn1caVxzAyDvUcchvHPFOLcfVxpzbgDkZCt9eO/DOoQ1xtEgmYFCjhNj6z982I7TliDiWJpfMwOFDIGxppUmMkZW5Cs3MEgv90y6yJiDG7uBQyQmZ5lcYhQ3rtgcWVcDh0hMDjrBDSC2zsQh8lVvkxLC+hOIZ3O6xPv5FYhnc+ziEl6CrDJZujg2cfwfhKxtsnK/vAYZJJusxAJSDXIiXueQuYmLG9RSSaxSlJTs14aIqUGVMEL1pYFj4uQhMyhpSfrGPaTPDUryn7nVCiV6blArseTGICGiPMmRG1QLWex7tR8E6wZVuQCiXgn5S7nIBxD2Tnlmow4ZAvVLhc51HVO9wrEjKkGFiqCJDW779tErtm+3VGjLnOA8Qk4eUqEWUZWSWXOOQSrklMRtifmWU/mW0BmE5yQHRqUHz6QQGGiIQxKj+BTar3tIqxDox14sGuaDO6beoiF75YdR1Due6PZnCAz9SKuSn4xDe8b8AEk2QJz8BEcgcmv9KIj+p2vHMR4uVycQ2NLCLokAHce2jwMCWQiacnI2iPB/CZZ9iYxA7uLbXmBxbEJDnGOkTPNoAtvDLh2d1JdtX5rX0uGACuygrDD3+kfInZ+ejGlklqIQ94iYQ0ifDPPQi8I1zSHtPyGjaSPBNAjdh58mdBD+AgQGOsQfguyQIDp4B0R16UFgWxbFrBUIJQlvgexTGdQ3mKYVevMw0jeBKGMpz4Yta07V1VGLt4SMewhqM8juAsDMsZuRH2WgMGO6pTEBybZPTCD/SZ6/BG9/7h6FjBQYhJaBe0CE/wQ8V/68MQGhQpX/CnGFR6m8/XlPxPM6hB6ERJBNBiuzOwaXtAcJ1Tkrbl6htAPdPiSxoCl5xnZ/BEJGFCIBnB2i5dN59OasKvWncYyzq0DuSIcq7WYQosFt0BNyk6k3cVsNooHySDaPkLWEvJl+at9UiJfnlDtGccFzVQ/GwoTxBHJghaAZIAsyGuWOqWptBO3InKKw7RdEIib6cJ8fqhAX1dM+zk+OPWhCIIN0SWoBBS4PV6bwHMy0S1KkuVx4GBtLH+Wc0azslVufqyu+Oc2IWPmW5OmjKlelGSkrD720M2/9siP8ZIPl0Tp400yf+OZ+eq9UITXIQiMwXXI6la8JaCyFWUD6KkTEqqEwHXKfLKclhBKjMB2yBMtpCeGwJCggKmhPX6xIpQ0ERCYVSD5xAlsfrL8lnZiozD6+XlVSyRsun8p/IMXpwk/7g8m+858Y8lslLYHTPU8KWRoObFXy46S1IRyTww+QosQ8m3pQ9PJXSP3vDvFK3w5Yl1tZqf+pogdX6QWsy226vv0fRH9HqhbSARkDdwDFiX64E1KdIQAAAABJRU5ErkJggg=="},tYoD:function(t,e){String.prototype.gblen=function(){for(var t=0,e=0;e<this.length;e++)this.charCodeAt(e)>127||94==this.charCodeAt(e)?t+=2:t++;return t}}},["gdAc"]);
//# sourceMappingURL=article.edit.94f4cba3cbad7cbbaf2b.js.map